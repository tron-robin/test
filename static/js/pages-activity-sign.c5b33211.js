(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-activity-sign"],{"0913":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return i}));var i={lSignature:n("5fea").default},a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("v-uni-view",{staticStyle:{width:"750rpx",height:"750rpx"}},[n("l-signature",{ref:"signatureRef",attrs:{disableScroll:!0,backgroundColor:"#ddd",penColor:t.penColor,penSize:t.penSize,openSmooth:t.openSmooth}})],1),n("v-uni-view",{staticClass:"flex align-center ml-3 mt-3"},[n("v-uni-button",{staticClass:"flex-1 mr-3 bg-main text-white",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.signClick("clear")}}},[t._v("清空")]),n("v-uni-button",{staticClass:"flex-1 mr-3 bg-primary text-white",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.signClick("undo")}}},[t._v("撤消")]),n("v-uni-button",{staticClass:"flex-1 mr-3 bg-orange text-white",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.signClick("save")}}},[t._v("保存")])],1)],1)},r=[]},"2b8e":function(t,e,n){"use strict";n("7a82");var i=n("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.uniContext=e.toDataURL=e.createImage=void 0,e.useCurrentPage=function(){var t=getCurrentPages();return t[t.length-1]};var a=i(n("f3f3")),r=i(n("276c")),o=i(n("e954"));n("99af"),n("d3b7");e.uniContext=function(t,e){var n=uni.createCanvasContext(t,e);return n.uniDrawImage||(n.uniDrawImage=n.drawImage,n.drawImage=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),a=1;a<e;a++)i[a-1]=arguments[a];n.uniDrawImage.apply(n,[t.src].concat(i))}),n.getImageData||(n.getImageData=function(n,i,a,r){return new Promise((function(o,s){e.proxy&&(e=e.proxy),uni.canvasGetImageData({canvasId:t,x:n,y:i,width:a,height:r,success:function(t){o(t)},fail:function(t){s(t)}},e)}))}),n};var s=function(){function t(){(0,r.default)(this,t),this.currentSrc=null,this.naturalHeight=0,this.naturalWidth=0,this.width=0,this.height=0,this.tagName="IMG"}return(0,o.default)(t,[{key:"src",get:function(){return this.currentSrc},set:function(t){var e=this;this.currentSrc=t,uni.getImageInfo({src:t,success:function(t){e.naturalWidth=e.width=t.width,e.naturalHeight=e.height=t.height,e.onload()},fail:function(){e.onerror()}})}}]),t}();e.createImage=function(){return new s};e.toDataURL=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(i,r){var o=n.canavs,s=(0,a.default)((0,a.default)({},n),{},{canvasId:t,success:function(t){i(t.tempFilePath)},fail:function(t){r(t)}});o&&o.toTempFilePath?o.toTempFilePath(s):uni.canvasToTempFilePath(s,e)}))}},"3a65":function(t,e,n){"use strict";n.r(e);var i=n("6f78"),a=n.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);e["default"]=a.a},"4f64":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show?n("v-uni-view",{ref:"limeSignature",staticClass:"lime-signature",style:[t.canvasStyle,t.styles]},[t.useCanvas2d?n("v-uni-canvas",{staticClass:"lime-signature__canvas",attrs:{id:t.canvasId,type:"2d",disableScroll:t.disableScroll},on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.touchStart.apply(void 0,arguments)},touchmove:function(e){arguments[0]=e=t.$handleEvent(e),t.touchMove.apply(void 0,arguments)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.touchEnd.apply(void 0,arguments)}}}):n("v-uni-canvas",{staticClass:"lime-signature__canvas",attrs:{disableScroll:t.disableScroll,"canvas-id":t.canvasId,id:t.canvasId,width:t.canvasWidth,height:t.canvasHeight},on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.touchStart.apply(void 0,arguments)},touchmove:function(e){arguments[0]=e=t.$handleEvent(e),t.touchMove.apply(void 0,arguments)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.touchEnd.apply(void 0,arguments)},mousedown:function(e){arguments[0]=e=t.$handleEvent(e),t.touchStart.apply(void 0,arguments)},mousemove:function(e){arguments[0]=e=t.$handleEvent(e),t.touchMove.apply(void 0,arguments)},mouseup:function(e){arguments[0]=e=t.$handleEvent(e),t.touchEnd.apply(void 0,arguments)}}}),n("v-uni-canvas",{staticClass:"offscreen",style:"width:"+t.offscreenSize[0]+"px;height:"+t.offscreenSize[1]+"px",attrs:{"canvas-id":"offscreen",id:"offscreen",width:t.offscreenSize[0],height:t.offscreenSize[1]}})],1):t._e()},a=[]},"5c7c":function(t,e,n){"use strict";n.r(e);var i=n("a383"),a=n.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);e["default"]=a.a},"5fea":function(t,e,n){"use strict";n.r(e);var i=n("4f64"),a=n("82b8");for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);var o=n("3a65");for(var r in o)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(r);n("d9d7");var s=n("f0c5");a["default"].__module="sign";var u=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"177b6dba",null,!1,i["a"],a["default"]);e["default"]=u.exports},"6f78":function(t,e,n){"use strict";n("7a82");var i=n("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n("f07e")),r=i(n("c964"));n("e9c4");var o=n("a60f"),s=n("d150"),u=n("2b8e"),c=i(n("94ee")),h={props:c.default,data:function(){return{canvasWidth:null,canvasHeight:null,offscreenWidth:null,offscreenHeight:null,useCanvas2d:!0,show:!0,offscreenStyles:""}},computed:{canvasId:function(){return"lime-signature".concat(this._uid)},offscreenId:function(){return this.canvasId+"offscreen"},offscreenSize:function(){var t=this.offscreenWidth,e=this.offscreenHeight;return this.landscape?[e,t]:[t,e]},canvasStyle:function(){var t=this.canvasWidth,e=this.canvasHeight,n=this.backgroundColor;return{width:t&&t+"px",height:e&&e+"px",background:n}},param:function(){var t=this.penColor,e=this.penSize,n=this.backgroundColor,i=this.landscape,a=this.boundingBox,r=this.openSmooth,o=this.minLineWidth,s=this.maxLineWidth,u=this.minSpeed,c=this.maxWidthDiffRate,h=this.maxHistoryLength,l=this.disableScroll;return JSON.parse(JSON.stringify({penColor:t,penSize:e,backgroundColor:n,landscape:i,boundingBox:a,openSmooth:r,minLineWidth:o,maxLineWidth:s,minSpeed:u,maxWidthDiffRate:c,maxHistoryLength:h,disableScroll:l}))}},created:function(){this.useCanvas2d="2d"==this.type&&(0,o.canIUseCanvas2d)()},mounted:function(){var t=this;return(0,r.default)((0,a.default)().mark((function e(){var n;return(0,a.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.beforeDelay){e.next=3;break}return e.next=3,(0,o.sleep)(t.beforeDelay);case 3:return e.next=5,t.getContext();case 5:n=e.sent,t.signature=new s.Signature(n),t.canvasEl=t.signature.canvas.get("el"),t.offscreenWidth=t.canvasWidth=t.signature.canvas.get("width"),t.offscreenHeight=t.canvasHeight=t.signature.canvas.get("height"),t.stopWatch=t.$watch("param",(function(e){t.signature.pen.setOption(e)}),{immediate:!0});case 11:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){this.stopWatch&&this.stopWatch(),this.signature.destroy(),this.show=!1,this.signature=null},methods:{undo:function(){this.signature&&this.signature.undo()},clear:function(){this.signature&&this.signature.clear()},isEmpty:function(){return this.signature.isEmpty()},canvasToTempFilePath:function(t){var e=this,n=this.isEmpty(),i=function(e){return t.fail&&t.fail(e)},s=this.signature.canvas.get("el"),c=s.canvas,h=this.backgroundColor,l=this.landscape,f=this.boundingBox,d=this.signature.canvas.get("width"),v=this.signature.canvas.get("height"),p=0,g=0,y=function(i){var a=uni.createCanvasContext("offscreen",e);a.save(),a.setTransform(1,0,0,1,0,0),l&&(a.translate(0,d),a.rotate(-Math.PI/2)),h&&(a.fillStyle=h,a.fillRect(0,0,d,v)),a.drawImage(i,0,0,d,v),a.draw(!1,(function(){(0,u.toDataURL)("offscreen",e,t).then((function(e){var i=Math.max(d,v);a.restore(),a.clearRect(0,0,i,i),function(e){t.success&&t.success(e)}({tempFilePath:e,isEmpty:n})}))}))},m=function(){var t={x:p,y:g,width:d,height:v,canvas:e.useCanvas2d?c:null};(0,u.toDataURL)(e.canvasId,e,t).then(y).catch(i)};f?this.signature.getContentBoundingBox(function(){var t=(0,r.default)((0,a.default)().mark((function t(n){return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.offscreenWidth=d=n.width,e.offscreenHeight=v=n.height,p=n.startX,g=n.startY,t.next=6,(0,o.sleep)(100);case 6:m();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):m()},getContext:function(){var t=this;return(0,o.getRect)("#".concat(this.canvasId),{context:this,type:this.useCanvas2d?"fields":"boundingClientRect"}).then((function(e){if(e){var n,i=e.width,a=e.height,r=e.node,s=e.left,c=e.top,h=e.right,l=uni.getSystemInfoSync(),f=l.pixelRatio;return r?(n=r.getContext("2d"),r.width=i*f,r.height=a*f):(f=1,n=(0,u.uniContext)(t.canvasId,t),r={createImage:u.createImage,toDataURL:function(){return(0,u.toDataURL)(t.canvasId,t)},requestAnimationFrame:o.requestAnimationFrame}),n.clearRect(0,0,i,a),{left:s,top:c,right:h,width:i,height:a,context:n,canvas:r,pixelRatio:f}}}))},touchStart:function(t){this.canvasEl&&(this.isStart=!0,this.canvasEl.dispatchEvent("touchstart",(0,o.wrapEvent)(t)))},touchMove:function(t){!this.canvasEl||!this.isStart&&this.canvasEl||this.canvasEl.dispatchEvent("touchmove",(0,o.wrapEvent)(t))},touchEnd:function(t){this.canvasEl&&(this.isStart=!1,this.canvasEl.dispatchEvent("touchend",(0,o.wrapEvent)(t)))}}};e.default=h},7220:function(t,e){},"82b8":function(t,e,n){"use strict";n.r(e);var i=n("a3b0"),a=n.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);e["default"]=a.a},"8bed":function(t,e,n){"use strict";var i=n("cbcb"),a=n.n(i);a.a},"94ee":function(t,e,n){"use strict";n("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("a9e3");var i={styles:String,disableScroll:{type:Boolean,default:!0},type:{type:String,default:"2d"},penColor:{type:String,default:"black"},penSize:{type:Number,default:2},backgroundColor:String,openSmooth:Boolean,minLineWidth:{type:Number,default:2},maxLineWidth:{type:Number,default:6},minSpeed:{type:Number,default:1.5},maxWidthDiffRate:{type:Number,default:20},maxHistoryLength:{type:Number,default:20},beforeDelay:{type:Number,default:0},landscape:{type:Boolean},boundingBox:{type:Boolean}};e.default=i},a383:function(t,e,n){"use strict";n("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={data:function(){return{title:"Hello",penColor:"black",penSize:5,url:"",openSmooth:!0}},methods:{signClick:function(t){var e=this;"save"!=t?this.$refs.signatureRef&&this.$refs.signatureRef[t]():e.$refs.signatureRef.canvasToTempFilePath({success:function(t){vk.uploadFile({title:"上传中...",filePath:t.tempFilePath,success:function(t){e.url=t.url;var n=e.getOpenerEventChannel();n.emit&&n.emit("sign_name",t.url),vk.navigateBack()}})}})}}};e.default=i},a3b0:function(t,e,n){"use strict";n("7a82");var i=n("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n("7220")),r=a.default;e.default=r},a60f:function(t,e,n){"use strict";n("7a82");var i=n("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.base64ToPath=function(t){var e=/data:image\/(\w+);base64,(.*)/.exec(t)||[],n=(0,a.default)(e,3);n[1],n[2];return new Promise((function(t,e){}))},e.canIUseCanvas2d=function(){return!1},e.compareVersion=r,e.getRect=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="boundingClientRect",i=e.context,a=e.type,r=void 0===a?n:a;return new Promise((function(e,a){var o=uni.createSelectorQuery().in(i).select(t),s=function(t){t?e(t):a()};r==n?o[r](s).exec():o[r]({node:!0,size:!0,rect:!0},s).exec()}))},e.requestAnimationFrame=void 0,e.sleep=function(t){return new Promise((function(e){return setTimeout(e,t)}))},e.wrapEvent=void 0;var a=i(n("d0af"));function r(t,e){t=t.split("."),e=e.split(".");var n=Math.max(t.length,e.length);while(t.length<n)t.push("0");while(e.length<n)e.push("0");for(var i=0;i<n;i++){var a=parseInt(t[i],10),r=parseInt(e[i],10);if(a>r)return 1;if(a<r)return-1}return 0}n("14d9"),n("e25e"),n("ac1f"),n("d3b7");e.wrapEvent=function(t){if(t)return t.preventDefault||(t.preventDefault=function(){}),t};e.requestAnimationFrame=function(t){setTimeout(t,30)}},aa29:function(t,e,n){var i=n("db51");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=n("4f06").default;a("16d33677",i,!0,{sourceMap:!1,shadowMode:!1})},cb29:function(t,e,n){"use strict";var i=n("23e7"),a=n("81d5"),r=n("44d2");i({target:"Array",proto:!0},{fill:a}),r("fill")},cbcb:function(t,e,n){var i=n("f5bd");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=n("4f06").default;a("995fbf36",i,!0,{sourceMap:!1,shadowMode:!1})},d150:function(t,e,n){"use strict";var i=n("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.Signature=void 0;var a=i(n("0122"));function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function o(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t){return s="function"==typeof Symbol&&"symbol"==(0,a.default)(Symbol.iterator)?function(t){return(0,a.default)(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":(0,a.default)(t)},s(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function v(t,e){return v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},v(t,e)}function p(t,e){if(e&&("object"==(0,a.default)(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=d(t);if(e){var a=d(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return p(this,n)}}n("b64b"),n("a4d3"),n("4de4"),n("d3b7"),n("e439"),n("14d9"),n("159b"),n("dbb4"),n("1d1c"),n("7a82"),n("e01a"),n("d28b"),n("3ca3"),n("ddb0"),n("d9e2"),n("d401"),n("131a"),n("3410"),n("f8c9"),n("4ae1"),n("a434"),n("acd8"),n("a9e3"),n("cb29"),n("fb6a");var y=function(t){var e=s(t);return null!==t&&"object"===e||"function"===e},m={}.toString,b=function(t,e){return m.call(t)==="[object "+e+"]"},x=function(t){return b(t,"String")},w=function(t){return b(t,"Number")},S=function(t){return b(t,"Function")},E=function(){function t(){u(this,t),this.__events=void 0,this.__events={}}return h(t,[{key:"on",value:function(t,e){if(t&&e){var n=this.__events[t]||[];n.push(e),this.__events[t]=n}}},{key:"emit",value:function(t,e){var n=this;if(y(t)&&(t=(e=t)&&e.type),t){var i=this.__events[t];i&&i.length&&i.forEach((function(t){t.call(n,e)}))}}},{key:"off",value:function(t,e){var n=this.__events,i=n[t];if(i&&i.length)if(e)for(var a=0,r=i.length;r>a;a++)i[a]===e&&(i.splice(a,1),a--);else delete n[t]}},{key:"getEvents",value:function(){return this.__events}}]),t}(),_=function(t){f(n,E);var e=g(n);function n(t,i){var a;return u(this,n),(a=e.call(this)).context=void 0,a.canvas=void 0,a.attrs=void 0,a.isCanvasElement=void 0,a.context=t,a.canvas=i.canvas||t.canvas||{width:i.width||0,height:i.height||0},a.attrs=i||{},a.isCanvasElement=!0,a}return h(n,[{key:"width",get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},{key:"height",get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}},{key:"getContext",value:function(){return this.context}},{key:"getBoundingClientRect",value:function(){var t=this.attrs||{},e=t.top,n=t.right,i=t.width,a=t.height,r=t.left,o=t.bottom;return{top:void 0===e?0:e,width:void 0===i?0:i,right:void 0===n?0:n,height:void 0===a?0:a,bottom:void 0===o?0:o,left:void 0===r?0:r}}},{key:"setAttribute",value:function(t,e){this.attrs[t]=e}},{key:"addEventListener",value:function(t,e){this.on(t,e)}},{key:"removeEventListener",value:function(t,e){this.off(t,e)}},{key:"dispatchEvent",value:function(t,e){this.emit(t,e)}}]),n}();function k(t,e){try{return t.currentStyle?t.currentStyle[e]:document.defaultView&&document.defaultView.getComputedStyle(t,null).getPropertyValue(e)}catch(t){return{width:300,height:150}[e]}}function C(t,e){var n=e.get("el");if(!n)return t;var i=n.getBoundingClientRect(),a=i.top,r=void 0===a?0:a,o=i.left,s=void 0===o?0:o,u=parseFloat(k(n,"padding-left"))||0,c=parseFloat(k(n,"padding-top"))||0;return{x:t.x-s-u,y:t.y-r-c}}function P(t,e){var n=e.get("landscape");if(!n)return t;if(S(n))return n(t,e);var i=e.get("height");return{x:t.y,y:i-t.x}}var M=function(t,e){var n=t.touches;if(!n||!n.length)return[P(C({x:t.clientX,y:t.clientY},e),e)];n.length||(n=t.changedTouches||[]);for(var i=[],a=0,r=n.length;r>a;a++){var o,s=n[a],u=s.x,c=s.y,h=s.clientX,l=s.clientY;o=w(u)||w(c)?{x:u,y:c}:C({x:h,y:l},e),i.push(P(o,e))}return i},L=function(t,e){var n=e.x-t.x,i=e.y-t.y;return Math.abs(n)>Math.abs(i)?n>0?"right":"left":i>0?"down":"up"},T=function(t,e){var n=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return Math.sqrt(n*n+i*i)},D=function(){function t(e){var n=this,i=e.canvas,a=e.el;u(this,t),this.processEvent=void 0,this.canvas=void 0,this.startTime=0,this.endTime=0,this.startPoints=null,this.startDistance=0,this.center=null,this.pressTimeout=void 0,this.eventType=null,this.direction=null,this.lastMoveTime=0,this.prevMovePoints=null,this.prevMoveTime=0,this.lastMovePoints=null,this.pinch=!1,this._click=function(t){var e=M(t,n.canvas);t.points=e,n.emitEvent("click",t)},this._start=function(t){var e,i,a=M(t,n.canvas);a&&(t.points=a,n.emitEvent("touchstart",t),n.reset(),n.startTime=Date.now(),n.startPoints=a,a.length>1?(n.startDistance=T(a[0],a[1]),n.center={x:(e=a[0]).x+((i=a[1]).x-e.x)/2,y:e.y+(i.y-e.y)/2}):n.pressTimeout=setTimeout((function(){var e="press",i="none";t.direction=i,n.emitStart(e,t),n.emitEvent(e,t),n.eventType=e,n.direction=i}),250))},this._move=function(t){var e=M(t,n.canvas);if(e){t.points=e,n.emitEvent("touchmove",t);var i=n.startPoints;if(i)if(e.length>1){var a=n.startDistance,r=T(e[0],e[1]);t.zoom=r/a,t.center=n.center,n.emitStart("pinch",t),n.emitEvent("pinch",t)}else{var o=e[0].x-i[0].x,s=e[0].y-i[0].y,u=n.direction||L(i[0],e[0]);n.direction=u;var c=n.getEventType(e);t.direction=u,t.deltaX=o,t.deltaY=s,n.emitStart(c,t),n.emitEvent(c,t);var h=n.lastMoveTime,l=Date.now();l-h>0&&(n.prevMoveTime=h,n.prevMovePoints=n.lastMovePoints,n.lastMoveTime=l,n.lastMovePoints=e)}}},this._end=function(t){var e=M(t,n.canvas);t.points=e,n.emitEnd(t),n.emitEvent("touchend",t);var i=n.lastMoveTime;if(100>Date.now()-i){var a=i-(n.prevMoveTime||n.startTime);if(a>0){var r=n.prevMovePoints||n.startPoints,o=n.lastMovePoints;if(!r||!o)return;var s=T(r[0],o[0])/a;s>.3&&(t.velocity=s,t.direction=L(r[0],o[0]),n.emitEvent("swipe",t))}}n.reset();var u=t.touches;u&&u.length>0&&n._start(t)},this._cancel=function(t){n.emitEvent("touchcancel",t),n.reset()},this.canvas=i,this.delegateEvent(a),this.processEvent={}}return h(t,[{key:"delegateEvent",value:function(t){t.addEventListener("click",this._click),t.addEventListener("touchstart",this._start),t.addEventListener("touchmove",this._move),t.addEventListener("touchend",this._end),t.addEventListener("touchcancel",this._cancel)}},{key:"emitEvent",value:function(t,e){this.canvas.emit(t,e)}},{key:"getEventType",value:function(t){var e,n=this.eventType,i=this.startTime,a=this.startPoints;if(n)return n;var r=this.canvas.__events.pan;if(r&&r.length){var o=Date.now();if(!a)return;e=o-i>250&&10>T(a[0],t[0])?"press":"pan"}else e="press";return this.eventType=e,e}},{key:"enable",value:function(t){this.processEvent[t]=!0}},{key:"isProcess",value:function(t){return this.processEvent[t]}},{key:"emitStart",value:function(t,e){this.isProcess(t)||(this.enable(t),this.emitEvent("".concat(t,"start"),e))}},{key:"emitEnd",value:function(t){}},{key:"clearPressTimeout",value:function(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}},{key:"reset",value:function(){this.clearPressTimeout(),this.startTime=0,this.startPoints=null,this.startDistance=0,this.direction=null,this.eventType=null,this.pinch=!1,this.prevMoveTime=0,this.prevMovePoints=null,this.lastMoveTime=0,this.lastMovePoints=null}}]),t}(),W=function(t){f(n,E);var e=g(n);function n(t){var i;return u(this,n),(i=e.call(this))._attrs={},i._isWindow=void 0,i._attrs=Object.assign({},t),i._isWindow="undefined"!=typeof window,i._initPixelRatio(),i._initCanvas(),["createImage","toDataURL","requestAnimationFrame"].forEach((function(e){i._initAttrs(e,t.canvas||i.get("el"))})),i}return h(n,[{key:"get",value:function(t){return this._attrs[t]}},{key:"set",value:function(t,e){this._attrs[t]=e}},{key:"_initAttrs",value:function(t,e){var n=this;this.get(t)||this.set(t,(function(){return e[t]?e[t].apply(e,arguments):n._isWindow?window[t]?(i=window)[t].apply(i,arguments):"createImage"==t?new Image:null:void 0;var i}))}},{key:"_initCanvas",value:function(){var t,e,n=this.get("el"),i=this.get("context");if(!n&&!i)throw Error("请指定 id、el 或 context!");t=n?x(n)?(e=n)?document.getElementById(e):null:n:function(t,e){return t?function(t){if(!t)return!1;if(1!==t.nodeType||!t.nodeName||"canvas"!==t.nodeName.toLowerCase())return!1;var e=!1;try{t.addEventListener("eventTest",(function(){e=!0})),t.dispatchEvent(new Event("eventTest"))}catch(t){e=!1}return e}(t.canvas)?t.canvas:new _(t,e):null}(i,this._attrs),i&&t&&!t.getContext&&(t.getContext=function(){return i});var a=this.get("width")||function(t){var e=k(t,"width");return"auto"===e&&(e=t.offsetWidth),parseFloat(e)}(t)||t.width,r=this.get("height")||function(t){var e=k(t,"height");return"auto"===e&&(e=t.offsetHeight),parseFloat(e)}(t)||t.height;this.set("canvas",this),this.set("el",t),this.set("context",i||t.getContext("2d")),this.changeSize(a,r);var o=new D({canvas:this,el:t,parent:this.get("parent")});this.set("eventController",o)}},{key:"_initPixelRatio",value:function(){this.get("pixelRatio")||this.set("pixelRatio",window&&window.devicePixelRatio||1)}},{key:"changeSize",value:function(t,e){var n,i=this.get("pixelRatio"),a=this.get("el");a.style&&(a.style.width=t+"px",a.style.height=e+"px"),(n=a)&&"object"===s(n)&&(1===n.nodeType&&n.nodeName||n.isCanvasElement)&&(a.width=t*i,a.height=e*i,1!==i&&this.get("context").scale(i,i)),this.set("width",t),this.set("height",e)}},{key:"destroy",value:function(){if(!this.get("destroyed")){var t=this.get("el");t.width=0,t.height=0,this.clear(),this._attrs={},this.set("destroyed",!0)}}},{key:"clear",value:function(){}},{key:"isDestroyed",value:function(){return this.get("destroyed")}}]),n}(),O={penColor:"black",backgroundColor:"",openSmooth:!0,penSize:2,minLineWidth:2,maxLineWidth:6,minSpeed:1.5,maxWidthDiffRate:20,maxHistoryLength:20},R=function(){function t(e){var n=this;u(this,t),this.canAddHistory=!0,this.points=[],this.historyList=[],this.canvas=void 0,this._isEmpty=!0,this.active=!1,this.getLineWidth=function(t){var e=n.get("options"),i=e.minSpeed,a=e.minLineWidth,r=n.getMaxLineWidth();return Math.min(Math.max(r-(r-a)*t/Math.max(Math.min(i,10),1),a),r)},this.drawTrapezoid=function(t,e,i,a){var r=n.get("context");r.beginPath(),r.moveTo(Number(t.x.toFixed(1)),Number(t.y.toFixed(1))),r.lineTo(Number(e.x.toFixed(1)),Number(e.y.toFixed(1))),r.lineTo(Number(i.x.toFixed(1)),Number(i.y.toFixed(1))),r.lineTo(Number(a.x.toFixed(1)),Number(a.y.toFixed(1))),r.fillStyle=n.get("options").penColor,r.fill(),r.draw&&r.draw(!0)},this.drawNoSmoothLine=function(t,e){e.lastX=t.x+.5*(e.x-t.x),e.lastY=t.y+.5*(e.y-t.y),"number"==typeof t.lastX&&n.drawCurveLine(t.lastX,t.lastY,t.x,t.y,e.lastX,e.lastY,n.getMaxLineWidth())},this.drawCurveLine=function(t,e,i,a,r,o,s){s=Number(s.toFixed(1));var u=n.get("context");u.lineWidth=s,u.beginPath(),u.moveTo(Number(t.toFixed(1)),Number(e.toFixed(1))),u.quadraticCurveTo(Number(i.toFixed(1)),Number(a.toFixed(1)),Number(r.toFixed(1)),Number(o.toFixed(1))),u.stroke(),u.draw&&u.draw(!0)},this.getRadianData=function(t,e,n,i){var a=n-t,r=i-e;if(0===a)return{val:0,pos:-1};if(0===r)return{val:0,pos:1};var o=Math.abs(Math.atan(r/a));return n>t&&e>i||t>n&&i>e?{val:o,pos:1}:{val:o,pos:-1}},this.getRadianPoints=function(t,e,n,i){if(0===t.val)return 1===t.pos?[{x:e,y:n+i},{x:e,y:n-i}]:[{y:n,x:e+i},{y:n,x:e-i}];var a=Math.sin(t.val)*i,r=Math.cos(t.val)*i;return 1===t.pos?[{x:e+a,y:n+r},{x:e-a,y:n-r}]:[{x:e+a,y:n-r},{x:e-a,y:n+r}]},this.drawSmoothLine=function(t,e){var i=e.x-t.x,a=e.y-t.y;if(Math.abs(i)+Math.abs(a)>2?(e.lastX1=t.x+.3*i,e.lastY1=t.y+.3*a,e.lastX2=t.x+.7*i,e.lastY2=t.y+.7*a):(e.lastX1=e.lastX2=t.x+.5*i,e.lastY1=e.lastY2=t.y+.5*a),e.perLineWidth=(t.lineWidth+e.lineWidth)/2,"number"==typeof t.lastX1){if(n.drawCurveLine(t.lastX2,t.lastY2,t.x,t.y,e.lastX1,e.lastY1,e.perLineWidth),t.isFirstPoint)return;if(t.lastX1===t.lastX2&&t.lastY1===t.lastY2)return;var r=n.getRadianData(t.lastX1,t.lastY1,t.lastX2,t.lastY2),o=n.getRadianPoints(r,t.lastX1,t.lastY1,t.perLineWidth/2),s=n.getRadianPoints(r,t.lastX2,t.lastY2,e.perLineWidth/2);n.drawTrapezoid(o[0],s[0],s[1],o[1])}else e.isFirstPoint=!0},this.addHistory=function(){var t=n.get("options").maxHistoryLength;if(t&&n.canAddHistory)if(n.canAddHistory=!1,n.get("createImage")){var e=null;e=n.get("createImage")();var i=n.get("toDataURL")&&n.get("toDataURL")();x(i)?e.src=i:i.then((function(t){e.src=t})),e.onload=function(){n.historyList.push(e),n.historyList=n.historyList.slice(-t)}}else n.historyList.length++},this.drawByImage=function(t){var e=n.get("context"),i=n.get("width"),a=n.get("height");e.clearRect(0,0,i,a);try{e.drawImage(t,0,0,i,a),e.draw&&e.draw(!0)}catch(t){n.historyList.length=0}},this.isEmpty=function(){return n.get("options").maxHistoryLength>0?0===n.historyList.length:n._isEmpty},this.clear=function(){var t=n.get("context");t.clearRect(0,0,n.get("width"),n.get("height")),t.draw&&t.draw(),n._isEmpty=!0,n.historyList.length=0},this.undo=function(){if(0===n.get("options").maxHistoryLength&&n.clear(),n.get("createImage")&&n.historyList.length){var t=n.historyList.splice(-1)[0];n.drawByImage(t),0===n.historyList.length&&n.clear()}},this.canvas=e,this.canvas.set("pen",O),this.init()}return h(t,[{key:"getOption",value:function(){}},{key:"setOption",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=o({},t),n=e.maxLineWidth;if(n&&t.penSize&&n==O.maxLineWidth){var i=Math.max(n,t.penSize);e.maxLineWidth=i}this.canvas.set("pen",Object.assign({},O,e))}},{key:"get",value:function(t){return this.canvas.get("options"==t?"pen":t)}},{key:"init",value:function(){var t=this;this.get("context").lineCap="round",this.canvas.on("touchstart",(function(e){return t.onDrawStart(e)})),this.canvas.on("touchmove",(function(e){return t.onDrawMove(e)})),this.canvas.on("touchend",(function(e){return t.onDrawEnd(e)}))}},{key:"drawBackground",value:function(){var t=this.get("context"),e=this.get("width"),n=this.get("height"),i=this.get("options"),a=i.backgroundColor,r=i.backgroundImage;a&&(t.fillStyle=a,t.fillRect(0,0,e,n),t.draw&&t.draw(!0)),r&&this.drawByImage(r)}},{key:"getContentBoundingBox",value:function(t){var e=this.get("pixelRatio"),n=this.get("width"),i=this.get("height"),a=this.get("el"),r="CANVAS"===a.nodeName,o=r?n:a.width,s=r?i:a.height;e=r?1:e;var u=function(n){for(var i=o,a=s,r=0,u=0,c=0;n.length>c;c+=4)if(n[c+3]>0){var h=c/4%o,l=Math.floor(c/4/o);i=Math.min(i,h),a=Math.min(a,l),r=Math.max(r,h),u=Math.max(u,l)}var f={width:(r-i+1)/e,height:(u-a+1)/e,startX:i/e,startY:a/e};return t&&t(f),f};if("CANVAS"===a.nodeName){var c=document.createElement("canvas");c.width=n,c.height=i;var h=c.getContext("2d");h.drawImage(a,0,0,n,i);var l=h.getImageData(0,0,n,i).data;return u(l)}var f,d=this.get("context").getImageData(0,0,o,s);return y(f=d)&&S(f.then)&&S(f.catch)?(d.then((function(t){return u(t.data)})),null):u(d.data)}},{key:"remove",value:function(){var t=this;this.canvas.off("touchstart",(function(e){return t.onDrawStart(e)})),this.canvas.off("touchmove",(function(e){return t.onDrawMove(e)})),this.canvas.off("touchend",(function(e){return t.onDrawEnd(e)}))}},{key:"disableScroll",value:function(t){t.preventDefault&&this.get("options").disableScroll&&t.preventDefault()}},{key:"onDrawStart",value:function(t){this.disableScroll(t);var e=t.points;if(this.active){this.canAddHistory=!0,this.get("context").strokeStyle=this.get("options").penColor;var n=e[0];this.initPoint(n.x,n.y)}}},{key:"onDrawMove",value:function(t){if(this.disableScroll(t),this.active){var e=t.points[0];this.initPoint(e.x,e.y),this.onDraw()}}},{key:"onDrawEnd",value:function(t){this.active&&(this.canAddHistory=!0,this.points=[])}},{key:"onDraw",value:function(){var t=this,e=this.get("context");if(this.points.length>=2){this.addHistory(),e.lineWidth=this.get("options").penSize||2;var n=this.points.slice(-1)[0],i=this.points.slice(-2,-1)[0],a=function(){t._isEmpty=!1,t.get("options").openSmooth?t.drawSmoothLine(i,n):t.drawNoSmoothLine(i,n)};"function"==typeof this.get("el").requestAnimationFrame?this.get("el").requestAnimationFrame((function(){return a()})):a()}}},{key:"getMaxLineWidth",value:function(){var t=this.get("options");return Math.min(t.penSize,t.maxLineWidth)}},{key:"initPoint",value:function(t,e){var n={x:t,y:e,t:Date.now()},i=this.points.slice(-1)[0];if(!i||i.t!==n.t&&(i.x!==t||i.y!==e)){if(this.get("options").openSmooth&&i){var a=this.points.slice(-2,-1)[0];if(n.distance=Math.sqrt(Math.pow(n.x-i.x,2)+Math.pow(n.y-i.y,2)),n.speed=n.distance/(n.t-i.t||.1),n.lineWidth=this.getLineWidth(n.speed),a&&a.lineWidth&&i.lineWidth){var r=(n.lineWidth-i.lineWidth)/i.lineWidth,o=this.get("options").maxWidthDiffRate/100;o=o>1?1:.01>o?.01:o,Math.abs(r)>o&&(n.lineWidth=i.lineWidth*(1+(r>0?o:-o)))}}this.points.push(n),this.points=this.points.slice(-3)}}}]),t}(),I=function(){function t(e){u(this,t),this.canvas=void 0,this._ee=void 0,this.pen=void 0;var n=new W(e);n.set("parent",this),this.canvas=n,this._ee=new E,this.pen=new R(n),this.init()}return h(t,[{key:"init",value:function(){this.pen.active=!0}},{key:"destroy",value:function(){this.canvas.destroy()}},{key:"clear",value:function(){this.pen.clear()}},{key:"undo",value:function(){this.pen.undo()}},{key:"save",value:function(){}},{key:"getContentBoundingBox",value:function(t){return this.pen.getContentBoundingBox(t)}},{key:"isEmpty",value:function(){return this.pen.isEmpty()}},{key:"on",value:function(t,e){this._ee.on(t,e)}},{key:"emit",value:function(t,e){this._ee.emit(t,e)}},{key:"off",value:function(t,e){this._ee.off(t,e)}}]),t}();e.Signature=I;var F=I;e.default=F},d9d7:function(t,e,n){"use strict";var i=n("aa29"),a=n.n(i);a.a},db51:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".lime-signature[data-v-177b6dba], .lime-signature__canvas[data-v-177b6dba]{width:100%;height:100%}.offscreen[data-v-177b6dba]{position:fixed;top:0;left:9999px}",""]),t.exports=e},f5bd:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,".bg-orange[data-v-e06939a2]{background-color:#ff8c00}.bg-primary[data-v-e06939a2]{background-color:#1e90ff}",""]),t.exports=e},fff8:function(t,e,n){"use strict";n.r(e);var i=n("0913"),a=n("5c7c");for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);n("8bed");var o=n("f0c5"),s=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,"e06939a2",null,!1,i["a"],void 0);e["default"]=s.exports}}]);